<% content_for(:title, "Settings") %>

<h1 class="text-2xl font-bold mb-6">Settings</h1>

<div class="bg-white border border-border rounded-lg p-6">
  <h2 class="text-lg font-semibold mb-4">Channels</h2>
  <p class="text-sm text-muted mb-6">
    Click the star to show or hide a channel from the dashboard feed.
    Click the bolt to enable or disable auto-summaries.
  </p>

  <% Workspace.includes(:slack_channels).find_each do |workspace| %>
    <% channels = workspace.slack_channels.current.order(:channel_name) %>
    <% next if channels.empty? %>

    <div class="mb-6">
      <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-2"><%= workspace.team_name %></h3>
      <ul class="divide-y divide-gray-100">
        <% channels.each do |channel| %>
          <li class="flex items-center justify-between py-2">
            <%= link_to channel.display_name, workspace_slack_channel_path(workspace, channel),
                  class: "text-sm hover:underline" %>
            <div class="flex items-center gap-2">
              <%= render "slack_channels/star", workspace: workspace, channel: channel %>
              <%= render "slack_channels/actionable", workspace: workspace, channel: channel %>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>
</div>

<% if http_basic_auth_configured? %>
  <div class="bg-white border border-border rounded-lg p-6 mt-6">
    <h2 class="text-lg font-semibold mb-4">Session</h2>
    <%= button_to "Log out", logout_path,
          method: :post,
          class: "text-sm text-red-600 hover:text-red-800 cursor-pointer bg-transparent border-0 p-0 underline" %>
  </div>
<% end %>
